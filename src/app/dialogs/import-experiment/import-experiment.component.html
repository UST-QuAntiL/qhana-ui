<input type="file" #file style="display: none" (change)="onFileAdded()" />
<div class="container" fxLayout="column" fxLayoutAlign="space-evenly stretch">
    <h1 mat-dialog-title>Import Experiment</h1>

    <!-- This is the content of the dialog, containing a list of the files to upload -->
    <mat-dialog-content fxFlex>
        <button [disabled]="(uploading || polling != 'NOT_STARTED') && !error " mat-raised-button color="primary"
            class="add-files-btn" (click)="addFile()">Choose File
        </button>
        <span mat-line class="file" *ngIf="addedFile">{{addedFile.name}}</span>
        <div *ngIf="addedFile">
            <mat-progress-bar class="progress-bar" *ngIf="addedFile"
                [mode]="uploadStatus == 'PENDING' ? 'indeterminate' : 'determinate'"
                [value]="uploadStatus == 'NOT_STARTED' ? 0 : 100"></mat-progress-bar>
        </div>
        <div *ngIf="polling != 'NOT_STARTED'">
            <p mat-line>Upload complete. Waiting for result...</p>
            <mat-progress-bar class="progress-bar" *ngIf="addedFile"
                [mode]="polling == 'PENDING' ? 'indeterminate' : 'determinate'" [value]="100"></mat-progress-bar>
        </div>
        <div *ngIf="polling == 'DONE' && !error">
            <p mat-line>{{pollingResult}}</p>
        </div>
        <div *ngIf="error">
            <p class="error">{{error}}</p>
        </div>
        <div *ngIf="waiting">
            <mat-progress-bar class="progress-bar" [mode]="'indeterminate'"></mat-progress-bar>
        </div>
    </mat-dialog-content>
    <div class="dialog-actions" mat-dialog-actions>
        <button mat-button (click)="onCancel()">Cancel</button>
        <button mat-button (click)="import()" [disabled]="!addedFile || polling!= 'NOT_STARTED'">Import
            Experiment</button>
    </div>
</div>
